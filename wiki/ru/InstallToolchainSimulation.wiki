#summary Описание некоторых симуляторов, на которых можно запустить  embox

== TSIM ==

 # Установить [ftp://ftp.gaisler.com/gaisler.com/tsim/tsim-eval-2.0.18.tar.gz tsim-eval]
 # tsim-leon3 -gdb
 # Присоединиться к gdb серверу

== QEMU ==

Установить [http://wiki.qemu.org/Download QEMU]

Установка GRUB на образ диска, используемый Qemu:

 # Создать образ диска (21 MB)
{{{
dd if=/dev/zero of=hd0.img count=40320
}}}
 # Создать раздел на образе диска
{{{
/sbin/fdisk hd0.img
}}}
  # Задать геометрию диска:
   * x - extra functionality
   * h 16
   * s 63
   * c 40
   * r - return to main menu
  # n, p, 1, enter, enter - create new partition
  # a 1 - make bootable
  # w - write the table to disk
 # Setup the loopback device (1048576 =  2048 x 512 bytes)
{{{
/sbin/fdisk -u -l hd0.img
sudo /sbin/losetup -o 1048576 /dev/loop0 hd0.img
}}}
 # Создать файловую систему
{{{
sudo /sbin/mkfs.ext2 /dev/loop0
}}}
 # Примонтировать образ
{{{
sudo mount /dev/loop0 /mnt/flash
}}}
 # Установить GRUB (stage1 и stage2 берутся с хостовой системы)
{{{
sudo mkdir -p /mnt/flash/boot/grub
sudo cp /boot/grub/stage1 /boot/grub/stage2 /mnt/flash/boot/grub
}}}
 # Put embox image
{{{
cp path/embox /mnt/flash
}}}
 # Отмонтировать образ диска
{{{
sudo umount /mnt/flash
}}}
 # Отсоединить loopback устройство
{{{
sudo /sbin/losetup -d /dev/loop0
}}}
 # Установить GRUB device map
{{{
/usr/sbin/grub --device-map=/dev/null
    > device (hd0) hd0.img
    > geometry (hd0) 40 16 63
    > root (hd0,0)
    > setup (hd0)
    > quit
}}}
 # Загрузиться с помощью Qemu
{{{
qemu -hda hd0.img -m 256
    grub> kernel /boot/embox
    grub> boot
}}}

== SKYEYE ==

Targeted to ARM simulation. Used for Atmel AT91 simulation as that installed in Lego NXT brick. Have UART support.
                            
Установить Skyeye:             

   [http://sourceforge.net/projects/skyeye/files/skyeye/skyeye-1.3.0_rc1.tar.gz/download skyeye-1.3.0rc1]

   [http://sourceforge.net/projects/skyeye/files/skyeye/skyeye-1.2.6_rc1/skyeye-1.2.6_rc1.tar.bz2/download skyeye-1.

 # Пример конфига skyeye.conf
{{{
arch:arm
cpu: arm7tdmi

mach: at91

mem_bank: map=M, type=RW,  addr=0x00000000,  size=0x10000000
mem_bank: map=I, type=RW,  addr=0xf0000000,  size=0x10000000
uart:mod=term
}}}

 # Запускаем симулятор
{{{
skyeye -d -c [path-to-embox]/third-party/conf/skyeye.conf
}}}

 # Загружаем embox в skyeye
{{{
arm-elf-gdb [path-to-embox-elf]
    (gdb) tar extended-remote :12345
    (gdb) load
}}}

 # Теперо можно отлаживать
{{{
    (gdb) c
}}}
