#summary HAL description, interface

HAL является уровнем абстракции, представляющий единый интерфейс для аппаратного 
обеспечения всех платформ, что
позволяет писать ядро платформо-независимо, на языке программирования высокого 
уровня. В HAL также входят абстракции основных системных устройств, таких как
часы, контроллер прерываний.

http://embox.googlecode.com/svn/wiki/images/Hal/hal.png

== Загрузочный код == 

Во время старта первым выполняется полностью
архитектурно-зависимый загрузочный код, чтобы обеспечить
первоначальную инициализацию ЦПУ.
Он переводит процессор в известный режим, 
копирует в оперативную память необходимые секции ядра, 
передает управление функции инициализации ядра.

== Режимы процессора ==

Ядру требуется управлять режимом работы процессора, такими как переключение 
в пользовательский режим, управлением кэшем данных и инструкций процессора,
и так далее.
HAL абстрагирует режимы процессора, предоставляя интерфейс для доступа 
к слову состояния
процессора, разрешению на прерывания, управление кэшем.

== Таблица прерывания ==

Как правило, [TheoryTraps прерывания] нумеруются, а адрес обработчика прерываний
записан в специальную таблицу прерываний по смещению, соответствующему 
номеру прерывания.
Ядру и драйверам требуется устанавливать собственные обработчики прерываний для 
некоторых прерываний, таких как такт системных часов, деление на ноль, и так далее. 
HAL предоставляет интерфейс для управления системной таблицей прерываний, 
функций получения и установки обработчиков, первичные обработчики прерываний.

== Атомарные операции ==

Во время разработки критических секций может возникнуть необходимость требовать, 
что данный участок программы не будет прерван и не будет начата обработка
какого-либо прерывания.
HAL предоставляет платформо-независимый механизм, с использованием которого
создавать такого рода критические секции.

== Контекст выполнения (процессора) == 

Для обеспечения [псевдомногозадачности] (иллюзии выполнения нескольких 
задач одновременно на одном процессоре) используется механизм переключения задач,
когда 
по сигналу происходит сохранение _контекста_ текущей задачи и переключение 
на следующую. Контекст это структура данных, представляющая описание состояния процессора,
достаточное, чтобы продолжить прерванную ранее задачу. 
Высокоуровневый [механизм ядра] определяет, когда следует совершить переключение,
и выполняет это посредством HAL.
HAL позволяет сохранить и восстановить, переключить контекст.

== Виртуальная память ==
Для предоставлении процессу линейного, изолированного от других процессов адресного 
пространства, ядро использует механизм 
[VirtualMemory виртуальной памяти].
HAL предоставляет примитивы для работы с аппаратным контроллером памяти (MMU), обеспечивающего
высокопроизводительную поддержку виртуальной памяти.
Интерфейс позволяет включить или отключить виртуальную память, создать
отображение физической памяти на виртуальную.

== Системные устройства == 
=== Контроллер прерываний ===

Система зачастую имеет несколько возможных источников аппаратных
[Traps прерываний]. Для простоты используется особый контроллер, независимо
разрешающий или запрещающий те или иные источники.
HAL включает интерфейс контроллера, предоставляющий возможность независимо
включить/выключить генерацию прерывания аппаратным прерыванием, получение 
источника аппаратного прерывания для обработчика прерываний.

=== Часы === 

Часы являются устройством, генерирующим прерывания через определенный равный
промежуток времени. Такт часов используется для вычисления относительного 
времени (время со старта системы), как сигнал для диспетчеризации таймеров,
переключения активного потока исполнения на более приоритетный. 
HAL предоставляет интерфейс часов, позволяющий провести инициализацию часов,
настроить период прерываний.

