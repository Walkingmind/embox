#summary HAL description, interface
 
Для упрощения взамиодействия ядра с оборудованием был введён уровень HAL
(Hardware Abstraction Layer). HAL абстрагирует базовые устройства: процессора,
контроллера прерываний и памяти,.., предоставляя ядру окружение для исполнения
программ, не зависящее от окружения. Выгоды от использования HAL:
кроссплатформенность, чёткое логическое разграничение логики работы с
утройствами от алгоритмов ядра. HAL представлен модулем, имеющим зависимости,
реализующие требуемую функциональность. Составные части: 

<wiki:toc max_depth="3" />

= HAL =  
== Загрузчик == 

Загрузчик это программное обеспечение, которому передаётся управление 
оборудованием при старте. Загрузчик копирует в оперативную память секции ядра,
переводит процессор в известный режим, передает управление ядру.

== Процессор ==

HAL абстрагирует процессор, предоставляя интерфейс для доступа к слову состояния
процессора, условным флагам, разрешение на прерывания.

== Таблица прерываний ==

Как правило, [Traps прерывания] нумеруются, а адрес обработчика прерываний
записан в таблицу прерываний по смещению, соответствующему номеру прерывания.
HAL предоставляет интерфейс для управления системной таблицей прерываний, 
функций получения и установки обработчиков.

== Контекст выполнения == 

Тип, представляющий полное описание состояния процессора. Контекст + программный
код представляют полное описание состояния вычислений. Используется для
переключения задач. HAL заведует сохранением, востановлением, переключением
контекстов. 

== [VirtualMemory Виртуальная память] ==

HAL так же предоставляет интерфейс для механизма [VirtualMemory виртуальной 
памяти]. Интерфейс позволяет включить или отключить виртуальную память, создать
отображение физческой памяти на виртуальную.

== Системные устройства == 
=== Часы === 

Часы являются устройством, генерирующим прерывания через определённый равный
промежуток времени. В системе часы представлены [Drivers драйвером] часов.
Система модулей гарантирует, что часы будут инициализированны до того, как будет
инициализироваться модуль HAL

=== Контроллер прерываний ===

Система зачастую имеет несколько возможных источников аппаратных 
[Traps прерываний]. Для простоты использутся особый контроллер, независимо
разрешающий или запрещающий те или иные источники. HAL имеет зависимость от
[Drivers драйвера] прерываний.

== Привелегированные инструкции ==

HAL пердоставляет доступ к привелегированным инструкциям, недоступных на более
высоких уровнях исполнения чем HAL. К ним относятся, например, инструкции ввода/вывода 
`in`/`out` процессора 
[http://en.wikipedia.org/wiki/X86_instruction_listings#Original_8086.2F8088_instructions 
Intel x86]

== Атомарные операции ==

HAL предоставляет доступ к операциям, используемых для [синхронизации]. Примером
такой операции может служить test-and-set, которая читает значение, и, в случае,
если значение ноль, устанавливает его ненулевым, затем возравщает прочитанное
значение. 

