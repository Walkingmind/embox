#summary Описание интерфейса доступного в системе для тестирования виртуальной памяти.

<wiki:toc max_depth="2" />

= Описание =

Виртуальная память - механизм позволяющий расширить физическое адресное пространство системы и защитить пространства различных процессов от друг друга.

В большинстве современных процессоров этот режим поддерживается на аппаратном уровне, но в каждой архитектуре по своему. Операционной системе необходимо скрыть от прикладного ПО механизм распределения памяти, и предоставить интерфейс по которому может быть запрошена область памяти.

В общем случае для реализации виртуального режима необходимы следующие части:
 # Таблица(ы) трансляции и работа с ними
 # Отслеживание и обработка промахов по страницам
 # механизм поиска свободных страниц и занесения из в таблицы трансляции

Все эти части нуждаются в тестировании. На данной странице описывается интерфейс позволяющий протестировать различные аспекты работы системе в режиме с виртуальной памятью.

= Работа с таблицами трансляции =

Таблица трансляции предоставляет соответствие физического и виртуального адреса, а так же содержит флаги используемые при работе с данной страницей памяти. Таблица трансляции может быть реализована программно, как например в процессоре Microblaze. В данном типе процессора используется таблица из 64 записей, по сути являющейся кэшем для таблиц трансляции.
Таким образом в терминах данной страницы занесение в таблицу трансляции, это занесение в программную таблицу трансляции. Термин близкий к каталогу страниц. А кэширование страницы по сути является указанием страницы сделаться валидной для аппаратуры. То есть в отличие от занесения станицы в таблицу при обращении к данному виртуальному адресу не будет возникать промах по странице.

Поскольку в Embox предусмотрен механизм тестирование системы в рабочем состоянии (фоновое тестирование). То в соответствующем модуле создаются таблицы трансляции для тестирования в момент теста их можно менять, а перед завершением теста все таблицы трансляции восстанавливаются и система продолжает работать.

= Исключительные ситуации =

Исключительными ситуациями являются следующие:
 * Промахи по страницам (виртуальный адрес не отображен на физический)
     * Промах по данным
     * Промах по инструкциям
 * Нарушение прав страницы (попытка выполнить недопустимое действие со страницей)
     * Запись в страницу защищенную от записи
     * Выполнение кода
     * Обращение из пользовательского режима

Исключительные ситуации поддерживаются аппаратно через механизм trap ов. В случае их возникновения происходит передача управления на соответствующий trap, и вызывается его обработчик. Для регистрации обработчика (отличного от основного) применяется Тестовый фреймворк для trap ов

= Поиск свободных страниц =
