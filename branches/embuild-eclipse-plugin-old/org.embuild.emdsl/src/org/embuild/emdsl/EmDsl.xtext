grammar org.embuild.emdsl.EmDsl with org.eclipse.xtext.common.Terminals

import "http://www.eclipse.org/emf/2002/Ecore" as ecore

generate emDsl "http://www.embuild.org/emdsl/EmDsl"

Model:
	Package;

terminal SL_COMMENT:
	'#' !('\n' | '\r')* ('\r'? '\n')?;

terminal ML_COMMENT:
	(SL_COMMENT)+;

FILENAME:
	 ID | '-' | '.'
;
WILDCARD returns ecore::EString:
	(FILENAME
		| '?' | '*'
		| '[' FILENAME
		 ('|' FILENAME)* ']'
	)+;
terminal FLAGNAME:
	'-' ('_' | 'A'..'Z')+
;

Package:
	'$_PACKAGE' Assignment name=QualifiedName
	(entities+=Entity*);

Entity:
	Module | Depend | Source | Require | CppFlag;


CppFlag:
	'$_CPPFLAGS' Assignment flagname=FLAGNAME
;


Assignment:
	':=' | '+=' | '=';

Require:
	'$_REQUIRES-' (superType=[Module|QualifiedName]) Assignment name=[Module|QualifiedName];

Module:
	'$_MODS' Assignment name=ID;

Depend:
	'$_DEPS-' (subject=[Module|QualifiedName]) Assignment module=[Module|QualifiedName];

Source:
	'$_SRCS-' (subject=[Module|QualifiedName]) Assignment filename=WILDCARD;

QualifiedName:
	ID ('.' ID)*;
